{% extends base %}
{% block header %}
<style>
    .markdown-body {
        border: 1px solid #d0d7de;
        border-radius: 6px;
        padding: 16px;
        background-color: #f6f8fa;
        overflow: auto;
        word-wrap: break-word;
        font-size: 14px;
        line-height: 1.6;
    }
    .markdown-body pre {
        background-color: #e8eaed;
        border-radius: 6px;
        padding: 12px;
        overflow-x: auto;
    }
    .markdown-body code {
        background-color: #e8eaed;
        border-radius: 3px;
        padding: 2px 6px;
        font-size: 85%;
    }
    .markdown-body pre code {
        background-color: transparent;
        padding: 0;
    }
    .markdown-body table {
        border-collapse: collapse;
        width: 100%;
    }
    .markdown-body table th,
    .markdown-body table td {
        border: 1px solid #d0d7de;
        padding: 6px 12px;
    }
    .markdown-body blockquote {
        border-left: 4px solid #d0d7de;
        padding-left: 12px;
        color: #656d76;
        margin: 8px 0;
    }
    .markdown-body img {
        max-width: 100%;
    }
</style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".markdown-body").forEach((el) => {
                marked.setOptions({
                    breaks: true
                });
                el.innerHTML = DOMPurify.sanitize(marked.parse(el.textContent));
            });
        });
    </script>
{% endblock header %}
{% block body %}
{% if data.type == "repo" %}
<div class="row">
    <div class="col-2">
        <img src="{{ data.avatar }}" class="rounded-circle img-fluid" />
    </div>
    <div class="col-10">
        <h2>{{ data.repo }}</h2>
        {{ data.description }}
    </div>
</div>
<div class="row">
    <div class="col">
        <h3>{{ text.repo.star }}</h3>
        <p>{{ data.stars }}</p>
        <h3>{{ text.repo.forks }}</h3>
        <p>{{ data.forks }}</p>
    </div>
    <div class="col">
        <h3>{{ text.repo.issues }}</h3>
        <p>{{ data.issues }}</p>
        <h3>{{ text.repo.language }}</h3>
        <p>{{ data.language }}</p>
    </div>
</div>

{% elif data.type == "issue" %}
<h2>{{ data.title }}</h2>
{{ data.repo }}<strong>#{{ data.number }}</strong>
<hr>
<div class="row">
    <div class="col-2">
        <img src="{{ data.avatar }}" class="rounded-circle img-fluid" />
    </div>
    <div class="col-10">
        <h4>{{ data.user }}</h4>
        <div class="markdown-body">{{ data.body }}</div>
    </div>
</div>
<hr>
<span class="badge bg-dark">{{ data.updated_at }}</span>
{% if data.state == "open" %}
<span class="badge bg-info">{{ text.issues.open }}</span>
{% else %}
<span class="badge bg-secondary">{{ text.issues.closed }}</span>
{% endif %}
{% for label in data.labels %}
<span class="badge text-light" style="background-color: {{label.color}};">{{ label.name }}</span>
{% endfor %}



{% elif data.type == "discussion" %}
<h2>{{ data.title }}</h2>
{{ data.repo }}<strong>#{{ data.number }}</strong>
<hr>
<div class="row">
    <div class="col-2">
        <img src="{{ data.avatar }}" class="img-fluid rounded-circle" />
    </div>
    <div class="col-10">
        <h4>{{ data.user }}</h4>
        <small>{{ text.discussion.at }} {{ data.category }}</small>
        <hr>
        <div class="markdown-body">{{ data.body }}</div>
    </div>
</div>
<hr>
<span class="badge bg-dark">{{ data.updated_at }}</span>
{% if data.state == "open" %}
<span class="badge bg-info">{{ text.issues.open }}</span>
{% else %}
<span class="badge bg-secondary">{{ text.issues.closed }}</span>
{% endif %}
{% for label in data.labels %}
<span class="badge text-light" style="background-color: {{label.color}};">{{ label.name }}</span>
{% endfor %}


{% elif data.type == "user" or data.type == "organization" %}
<div class="row">
    <div class="col-2">
        <img src="{{ data.avatar }}" class="rounded-circle img-fluid"  />
    </div>
    <div class="col-10">
        <h2>{{ data.name }}</h2>
        {{ data.login }}
    </div>
</div>
<table>
    <thead>
        <tr>
            <td>{{ text.user.followers }}</td>
            <td>{{ text.user.following }}</td>
            <td>{{ text.user.public_repos }}</td>
            <td>{{ text.user.location }}</td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{ data.followers }}</td>
            <td>{{ data.following }}</td>
            <td>{{ data.public_repos }}</td>
            <td>{{ text.location }}</td>
        </tr>
    </tbody>
</table>
<p>{{data.bio}}</p>

{% elif data.type == "pull" %}
<h2>{{ data.title }}</h2>
{{ data.repo }}<strong>#{{ data.number }}</strong>
<hr>
<div class="row">
    <div class="col-2">
        <img src="{{ data.avatar }}" class="rounded-circle img-fluid">
    </div>
    <div class="col-10">
        <h4>{{ data.user }}</h4>
        {{ text.pull.wants_to_merge }} {{data.from}} {{text.pull.into}} {{data.to}}
    </div>
</div>
<div class="markdown-body">{{ data.body }}</div>
<hr>
<span class="badge bg-dark">{{ data.updated_at }}</span>
{% if data.state == "open" %}
<span class="badge bg-info">{{ text.issues.open }}</span>
{% else %}
<span class="badge bg-success">{{ text.pull.merged }}</span>
{% endif %}
{% for label in data.labels %}
<span class="badge text-light" style="background-color: {{label.color}};">{{ label.name }}</span>
{% endfor %}
{% endif %}

{% endblock body %}